{"version":3,"file":"js-egov-authentication.es5.js","sources":["../../../modules/js-egov-authentication/src/egov-authentication.ts","../../../modules/js-egov-authentication/src/egovauth.ts","../../../modules/js-egov-authentication/src/environmentDetector.ts","../../../modules/js-egov-authentication/src/authenticationUrls.ts","../../../modules/js-egov-authentication/src/httpBackend.ts","../../../modules/js-egov-authentication/src/user.ts","../../../modules/js-egov-authentication/src/authSession.ts","../../../modules/js-egov-authentication/src/httpHandler.ts","../../../modules/js-egov-authentication/src/ui.service.ts","../../../modules/js-egov-authentication/src/localizations.ts","../../../modules/js-egov-authentication/src/polyfills.ts"],"sourcesContent":["// import 'core-js/es6/object';\r\n\r\nexport * from './egovauth';\r\nexport * from './authSession';\r\nexport * from './authenticationUrls';\r\nexport * from './egovAuthConfiguration.interface';\r\nexport * from './user';\r\nexport * from './localizations';\r\nexport * from './models/userProperties';\r\n","import { UserProperties } from './models/userProperties';\r\nimport { EgovAuthConfiguration } from './egovAuthConfiguration.interface';\r\nimport { AuthSession } from './authSession';\r\nimport { User } from './user';\r\nimport { HttpBackend } from './httpBackend';\r\nimport { XHRResponse, XHRRequest } from './models/xhr';\r\nimport { AuthenticationUrls } from './authenticationUrls';\r\nimport { EnvironmentDetector } from './environmentDetector';\r\nimport { HttpHandler } from './httpHandler';\r\n\r\nexport class Authentication {\r\n  static isConfigured: boolean;\r\n  private static configuration: EgovAuthConfiguration;\r\n  private static authSession: AuthSession;\r\n  private static authUrls: AuthenticationUrls;\r\n  private static sessionCreatedCb: Function;\r\n\r\n  /**\r\n\t * Configure the authentication library with the different available options\r\n\t *\r\n\t * @param {EgovAuthConfiguration} configuration The configuration options\r\n\t */\r\n  static configure(configuration: EgovAuthConfiguration) {\r\n    Authentication.isConfigured = true;\r\n    Authentication.configuration = configuration;\r\n\r\n    let envDetector = new EnvironmentDetector(configuration.environment, configuration.isHttps);\r\n    this.authUrls = new AuthenticationUrls(envDetector, configuration);\r\n  }\r\n\r\n  static isAuthenticated() {\r\n    return Authentication.authSession && Authentication.authSession.isAuthenticated;\r\n  }\r\n\r\n  /**\r\n\t * Returns the authentication configuration\r\n\t */\r\n  static getConfiguration() {\r\n    return Authentication.configuration;\r\n  }\r\n\r\n  static onSessionCreated(cb: Function) {\r\n    this.sessionCreatedCb = cb;\r\n  }\r\n\r\n  static getAuthSession() {\r\n    return this.authSession;\r\n  }\r\n\r\n  static handleAjaxResponse(xhr: XHRResponse) {\r\n    const config = Authentication.configuration;\r\n    HttpHandler.handleAjaxResponse(config, xhr);\r\n  }\r\n\r\n  static getUrls() {\r\n    return this.authUrls;\r\n  }\r\n\r\n  static getCurrent(options?: any) /*: Promise<User>*/ {\r\n    // cannot add Promise as it causes compilation errors in jsui -> try later\r\n    if (!Authentication.isConfigured) {\r\n      throw new Error('Not configured, please invoke .configure(..) first');\r\n    }\r\n\r\n    if (!Authentication.configuration.httpLibrary) {\r\n      throw new Error('No ajax library configured. Set the according property \"httpLibrary\"');\r\n    }\r\n\r\n    let httpBackend = new HttpBackend(Authentication.configuration.httpLibrary);\r\n\r\n    let ajaxOptions = (<any>Object).assign(\r\n      {},\r\n      {\r\n        url: this.getUrls().getCurrentUserUrl(),\r\n        method: 'GET'\r\n      },\r\n      options\r\n    );\r\n\r\n    return httpBackend.execute(ajaxOptions).then((userProps: UserProperties) => {\r\n      const user = new User(userProps);\r\n      Authentication.authSession = new AuthSession(\r\n        user,\r\n        Authentication.configuration,\r\n        this.authUrls,\r\n        httpBackend\r\n      );\r\n\r\n      if (this.sessionCreatedCb) {\r\n        this.sessionCreatedCb(Authentication.authSession);\r\n      }\r\n\r\n      return user;\r\n    });\r\n  }\r\n\r\n  /**\r\n\t * Manually initialize a new session by simply passing in the user object\r\n\t */\r\n  static initWithUser(user: UserProperties) {\r\n    if (!Authentication.isConfigured) {\r\n      throw new Error('Not configured, please invoke .configure(..) first');\r\n    }\r\n\r\n    let httpBackend = new HttpBackend(Authentication.configuration.httpLibrary);\r\n\r\n    Authentication.authSession = new AuthSession(\r\n      new User(user),\r\n      Authentication.configuration,\r\n      this.authUrls,\r\n      httpBackend\r\n    );\r\n  }\r\n}\r\n","import { EnvironmentPrefix } from './environmentPrefix';\r\n\r\nexport interface IEnvironmentDetector {\r\n    getEnvironmentPrefix(): EnvironmentPrefix;\r\n    getProtocol(): string;\r\n    getCurrentWindowUrl(): string;\r\n}\r\n\r\nexport class EnvironmentDetector implements IEnvironmentDetector {\r\n    private envPrefix: EnvironmentPrefix;\r\n\tprivate protocol: string = 'https';\r\n\r\n    constructor(prefix?: EnvironmentPrefix, isHttps?: boolean) {\r\n        if(prefix) {\r\n            this.envPrefix = prefix;\r\n        }\r\n\r\n        if(isHttps === false) {\r\n            this.protocol = 'http';\r\n        } \r\n    }\r\n\r\n    /**\r\n     * Returns the current environment prefix, which is either 'dev', 'test', 'demo', 'prod'.\r\n     */\r\n    getEnvironmentPrefix(): EnvironmentPrefix {\r\n        let environment:EnvironmentPrefix = ''; // equals to prod\r\n        \r\n        if(this.envPrefix) {\r\n            environment = this.envPrefix;\r\n        } else {\r\n            let url = this.getCurrentWindowUrl();\r\n            \r\n            if (url.indexOf('dev') !== -1 || url.indexOf('localhost') !== -1) {\r\n                environment = 'dev';\r\n            }\r\n            if (url.indexOf('test') !== -1) {\r\n                environment = 'test';\r\n            }\r\n            if (url.indexOf('demo') !== -1) {\r\n                environment = 'demo';\r\n            }\r\n        }\r\n\r\n        return environment;\r\n    }\r\n\r\n    /**\r\n     * Returns the current \r\n     */\r\n    getProtocol(): string {\r\n        let protocol;\r\n        if(this.protocol) {\r\n            protocol = this.protocol;\r\n        } else {\r\n            let tmpProtocol = (window && window.location.protocol);\r\n            // we get 'https:', or 'http:' and should get rid of the colon\r\n\r\n            if(tmpProtocol) {\r\n                protocol = tmpProtocol.replace(':', '');\r\n            }\r\n        }\r\n\r\n        return protocol;\r\n    }\r\n\r\n    /**\r\n     * Returns the current url.\r\n     */\r\n    getCurrentWindowUrl():string {\r\n        return window.location.href;\r\n    }\r\n\r\n}\r\n","import { EgovAuthConfiguration, UrlConfigFunc } from './egovAuthConfiguration.interface';\r\nimport { IEnvironmentDetector } from './environmentDetector';\r\nimport { EnvironmentPrefix } from \"./environmentPrefix\";\r\n\r\nexport class AuthenticationUrls {\r\n\tprivate apiPrefix:string = '/iamauth';\r\n\tprivate protocol: string = 'https';\r\n\r\n\tconstructor(private envDetector:IEnvironmentDetector, private egovConfig?: EgovAuthConfiguration) {\r\n\t\tif(!envDetector) {\r\n\t\t\tthrow 'You have to pass in a valid class that implements the IEnvironmentDetector interface.';\r\n\t\t}\r\n\r\n\t\t// set default api prefix to emptystring\r\n\t\tif(egovConfig) {\r\n\t\t\tlet prefix = this._resolveString(egovConfig.apiPrefix);\r\n\t\t\tif(prefix !== null) {\r\n\t\t\t\tthis.apiPrefix = prefix;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.protocol = envDetector.getProtocol();\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the url for fetching the user\r\n\t */\r\n\tpublic getCurrentUserUrl():string {\r\n\t\tif (this.egovConfig) {\r\n\t\t\tconst config = this._resolveString(this.egovConfig.userUrl);\r\n\t\t\tif(config !== null) {\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn `${this.apiPrefix}/user/current`;\r\n\t}\r\n\r\n\t/**\r\n\t * Get the url of the login page\r\n\t * @param backUrl - the url to redirect back to again\r\n\t */\r\n\tpublic getLoginPageUrl(backUrl?:string) {\r\n\t\tif (this.egovConfig) {\r\n\t\t\tconst config = this._resolveString(this.egovConfig.loginUrl);\r\n\t\t\tif(config !== null) {\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(!backUrl) {\r\n\t\t\tbackUrl = this.envDetector.getCurrentWindowUrl();\r\n\t\t}\r\n\r\n\t\treturn `${this.apiPrefix}/login?target=${encodeURIComponent(backUrl)}`;\r\n\t}\r\n\r\n\tpublic getLogoutPageUrl(backUrl?:string) {\r\n\t\tif (this.egovConfig) {\r\n\t\t\tconst config = this._resolveString(this.egovConfig.logoutUrl);\r\n\t\t\tif (config !== null) {\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(!backUrl) {\r\n\t\t\tbackUrl = this.envDetector.getCurrentWindowUrl();\r\n\t\t}\r\n\r\n\t\treturn `${this.apiPrefix}/logout?target=${encodeURIComponent(backUrl)}`;\r\n\t}\r\n\t\r\n\t/**\r\n\t * returns the url pointing to the profile homepage, where the user can see\r\n\t * and modify his profile.\r\n\t */\r\n\tpublic getProfilePageUrl() {\r\n\t\tif (this.egovConfig) {\r\n\t\t\tconst config = this._resolveString(this.egovConfig.myProfileUrl);\r\n\t\t\tif(config !== null) {\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet envPrefix:EnvironmentPrefix = this.envDetector.getEnvironmentPrefix();\r\n\t\tif(envPrefix !== '') {\r\n\t\t\tenvPrefix += '-';\r\n\t\t}\r\n\r\n\t\treturn `${this.protocol}://${envPrefix}iam.civis.bz.it/api/appurls/MyProfile`;\r\n\t}\r\n\r\n\tpublic getNewDelegationRequestUrl(backUrl?:string) {\r\n\t\tif(this.egovConfig) {\r\n\t\t\tconst config = this._resolveString(this.egovConfig.newDelegationUrl);\r\n\t\t\tif(config !== null) {\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(!backUrl) {\r\n\t\t\tbackUrl = this.envDetector.getCurrentWindowUrl();\r\n\t\t}\r\n\r\n\t\treturn `${this.apiPrefix}/requestDelegation?target=${encodeURIComponent(backUrl)}`;\r\n\t}\r\n\r\n\tpublic getChangeDelegationUrl() {\r\n\t\tif(this.egovConfig) {\r\n\t\t\tconst config = this._resolveString(this.egovConfig.changeDelegationUrl);\r\n\t\t\tif(config !== null) {\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn `${this.apiPrefix}/user/current`;\r\n\t}\r\n\t\r\n\tpublic getAccessDataUrl() {\r\n\t\tlet envPrefix:EnvironmentPrefix = this.envDetector.getEnvironmentPrefix();\r\n\t\tif(envPrefix !== '') {\r\n\t\t\tenvPrefix += '-';\r\n\t\t}\r\n\r\n\t\treturn `${this.protocol}://${envPrefix}iam.civis.bz.it/api/appurls/MyCredentials`;\r\n\t}\r\n\r\n\tpublic getDelegationsUrl() {\r\n\t\tlet envPrefix:EnvironmentPrefix = this.envDetector.getEnvironmentPrefix();\r\n\t\tif(envPrefix !== '') {\r\n\t\t\tenvPrefix += '-';\r\n\t\t}\r\n\r\n\t\treturn `${this.protocol}://${envPrefix}iam.civis.bz.it/api/appurls/MyDelegations`;\r\n\t}\r\n\r\n\tpublic getCurrentDelegationProfileUrl() {\r\n\t\tlet envPrefix:EnvironmentPrefix = this.envDetector.getEnvironmentPrefix();\r\n\t\tif(envPrefix !== '') {\r\n\t\t\tenvPrefix += '-';\r\n\t\t}\r\n\r\n\t\treturn `${this.protocol}://${envPrefix}iam.civis.bz.it/api/appurls/CurrentDelegationProfile`;\r\n\t}\r\n\r\n\tpublic getRepresentativesUrl() {\r\n\t\tlet envPrefix:EnvironmentPrefix = this.envDetector.getEnvironmentPrefix();\r\n\t\tif(envPrefix !== '') {\r\n\t\t\tenvPrefix += '-';\r\n\t\t}\r\n\r\n\t\treturn `${this.protocol}://${envPrefix}iam.civis.bz.it/api/appurls/CurrentDelegationRepresentatives`;\r\n\t}\r\n\r\n\tprivate _resolveString(param: string | UrlConfigFunc): string {\r\n\t\tif(param) {\r\n\t\t\tif(typeof param === 'function') {\r\n\t\t\t\treturn param(this.envDetector.getEnvironmentPrefix());\r\n\t\t\t} else {\r\n\t\t\t\t// must be a string\r\n\t\t\t\treturn param;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { User } from './user';\r\nimport { HttpLibraryFunc } from './egovAuthConfiguration.interface';\r\n\r\nexport class HttpBackend {\r\n  constructor(private ajaxLib: HttpLibraryFunc) {}\r\n\r\n  execute(ajaxOptions) {\r\n    return this.ajaxLib(ajaxOptions).then(userObject => {\r\n      var resultObj = userObject;\r\n\r\n      // watch out, if the actual response data is wrapped inside\r\n      // the data property (i.e. with Angular's $http)\r\n      if (userObject.data) {\r\n        resultObj = userObject.data;\r\n      }\r\n      return new User(resultObj);\r\n    });\r\n  }\r\n}\r\n","import { Delegation } from './models/delegation';\r\nimport { Owner } from './models/owner';\r\nimport { SessionInfo } from './models/sessionInfo';\r\nimport { Accreditation } from './models/accreditation';\r\nimport { UserProperties } from './models/userProperties';\r\nimport { AuthLanguageCode } from \"./localizations\";\r\n\r\nexport interface UserRole {\r\n\trole: string;\r\n\tfunctions: string[];\r\n}\r\n\r\nexport class User {\r\n\tpublic owner: Owner;\r\n\tpublic username: string;\r\n\tpublic language:AuthLanguageCode;\r\n\tpublic sessionInfo: SessionInfo;\r\n\t// public ownerId: number;\r\n\t// public roles: UserRole[];\r\n\t// public functions: string[];\r\n\tpublic delegations: Delegation[];\r\n\tpublic currentAccreditations: Accreditation[];\r\n\r\n\tconstructor(\r\n\t\tproperties: UserProperties\r\n\t) {\r\n\t\tif (properties) {\r\n\r\n\t\t\t// copy properties over\r\n\t\t\tfor (let key in properties) {\r\n\t\t\t\tif (properties.hasOwnProperty(key)) {\r\n\t\t\t\t\tthis[key] = properties[key];\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// if (properties.roles) {\r\n\t\t\t// \tthis.roles = properties.roles;\r\n\t\t\t// \tthis.functions = getDistinctFunctions(properties.roles);\r\n\t\t\t// }\r\n\t\t}\r\n\r\n\t\tthis.delegations = this.delegations || [];\r\n\t}\r\n\r\n\tget displayName() : string {\r\n\t\tif (this.owner && this.owner.firstname && this.owner.lastname) {\r\n            return `${this.owner.firstname} ${this.owner.lastname}`;\r\n        } else {\r\n            return this.username;\r\n        }\r\n\t}\r\n\r\n\tget activeDelegation(): Delegation {\r\n\t\tfor (var i = 0; i < this.delegations.length; i++) {\r\n\t\t\tif (this.sessionInfo && this.delegations[i].represented.id === this.sessionInfo.currentRepresentedId) {\r\n\t\t\t\treturn this.delegations[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// HACK\r\n\t_dummyValue; // to prevent being optimized out\r\n\tset isAuthenticated(value) {\r\n\t\t// just a dummy one...as we ignore the isAuthenticated property from the server\r\n\t\tthis._dummyValue = value;\r\n\t}\r\n\tget isAuthenticated():boolean {\r\n\t\treturn this.sessionInfo !== null && typeof(this.sessionInfo) !== 'undefined';\r\n\t}\r\n\r\n\thasRole(name: string): boolean {\r\n\t\tif(this.currentAccreditations) {\r\n\t\t\tfor(let accreditation of this.currentAccreditations) {\r\n\t\t\t\tif(accreditation.qualification && accreditation.qualification.uid === name) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetDelegation(id: number):Delegation {\r\n\t\tif (this.delegations) {\r\n\t\t\tlet foundDelegation = null;\r\n\r\n\t\t\tthis.delegations.forEach(delegation => {\r\n\t\t\t\tif (delegation.represented.id === id) {\r\n\t\t\t\t\t// we found the delegation\r\n\t\t\t\t\tfoundDelegation = delegation;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn foundDelegation;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\thasDelegationChanged(newRepresentedId: number) {\r\n\t\treturn this.sessionInfo.currentRepresentedId !== newRepresentedId;\r\n\t}\r\n\r\n}\r\n","import { AuthenticationUrls } from './authenticationUrls';\r\nimport { User } from './user';\r\nimport { HttpBackend } from './httpBackend';\r\nimport { EgovAuthConfiguration } from './egovAuthConfiguration.interface';\r\nimport { XHRResponse, XHRRequest } from './models/xhr';\r\nimport { UIService } from './ui.service';\r\nimport { HttpHandler } from './httpHandler';\r\n\r\nexport class AuthSession {\r\n  private sessionAuthenticated: boolean = false;\r\n  private REDIRECTURL_PLACEHOLDER: string = '{URLENCODED_TARGET}';\r\n  private userInterfaceService: UIService;\r\n\r\n  constructor(\r\n    private user: User,\r\n    private egovAuthOptions: EgovAuthConfiguration,\r\n    private authUrls: AuthenticationUrls,\r\n    private httpBackend: HttpBackend\r\n  ) {\r\n    // set defaults\r\n    this.egovAuthOptions = egovAuthOptions || <EgovAuthConfiguration>{};\r\n    // this.egovAuthOptions.changeDelegationUrl = egovAuthOptions.changeDelegationUrl || this.egovAuthOptions.userUrl;\r\n\r\n    this.sessionAuthenticated = user.isAuthenticated;\r\n    this.userInterfaceService = new UIService(user, egovAuthOptions);\r\n  }\r\n\r\n  get uiService() {\r\n    return this.userInterfaceService;\r\n  }\r\n\r\n  get isAuthenticated() {\r\n    return this.sessionAuthenticated;\r\n  }\r\n\r\n  public changeDelegation(newRepresentedId) {\r\n    if (\r\n      this.egovAuthOptions &&\r\n      this.egovAuthOptions.events &&\r\n      this.egovAuthOptions.events.changeDelegation\r\n    ) {\r\n      // user has full control, has to do the callback himself\r\n      let delegation = this.user.getDelegation(parseInt(newRepresentedId));\r\n      if (delegation) {\r\n        return this.egovAuthOptions.events.changeDelegation(delegation);\r\n      } else {\r\n        throw `Delegation with id ${newRepresentedId} not found.`;\r\n      }\r\n    } else {\r\n      return this.httpBackend.execute({\r\n        method: 'POST',\r\n        url: this.authUrls.getChangeDelegationUrl(),\r\n        headers: {\r\n          'Content-type': 'application/json; charset=UTF-8'\r\n        },\r\n        // data: `newDelegationId=${newRepresentedId}`\r\n        data: JSON.stringify({\r\n          newRepresentedId: newRepresentedId\r\n        })\r\n      });\r\n    }\r\n\r\n    // what if this fails????\r\n  }\r\n\r\n  restartApplication() {\r\n    window.location.reload();\r\n  }\r\n\r\n  public handleAjaxRequest(xhr: XHRRequest) {\r\n    HttpHandler.handleAjaxRequest(this.user, xhr);\r\n  }\r\n\r\n  /**\r\n\t * @deprecated use HttpHandler.handleAjaxResponse instead\r\n\t *\r\n\t */\r\n  public handleAjaxResponse(xhr: XHRResponse) {\r\n    HttpHandler.handleAjaxResponse(this.egovAuthOptions, xhr);\r\n  }\r\n\r\n  private _redirect(url: string) {\r\n    window.location.href = url;\r\n  }\r\n\r\n  private _retrieveCurrentWindowUrl(): string {\r\n    return window.location.href;\r\n  }\r\n\r\n  private _isNullOrUndefined(obj: any): boolean {\r\n    return obj === null || typeof obj === 'undefined';\r\n  }\r\n}\r\n","import { AuthenticationUrls } from './authenticationUrls';\r\nimport { User } from './user';\r\nimport { EgovAuthConfiguration } from './egovAuthConfiguration.interface';\r\nimport { XHRResponse, XHRRequest } from './models/xhr';\r\nimport { UIService } from './ui.service';\r\n\r\nexport class HttpHandler {\r\n  private static REDIRECTURL_PLACEHOLDER: string = '{URLENCODED_TARGET}';\r\n\r\n  public static handleAjaxRequest(user: User, xhr: XHRRequest) {\r\n    if (!xhr) {\r\n      throw 'You have to pass in a valid XHR object.';\r\n    }\r\n\r\n    if (user.sessionInfo && user.sessionInfo.currentRepresentedId) {\r\n      xhr.setRequestHeader('client-currentRepresentedId', user.sessionInfo.currentRepresentedId);\r\n    }\r\n\r\n    if (user && user.language) {\r\n      xhr.setRequestHeader('current-language', user.language);\r\n    }\r\n  }\r\n\r\n  public static handleAjaxResponse(egovAuthOptions: EgovAuthConfiguration, xhr: XHRResponse) {\r\n    if (!xhr) {\r\n      throw 'You have to pass in a valid XHR object.';\r\n    }\r\n\r\n    if (this._isNullOrUndefined(xhr.status)) {\r\n      throw 'You have to pass in a valid XHR object having a status property.';\r\n    }\r\n\r\n    if (this._isNullOrUndefined(xhr.url)) {\r\n      throw 'You have to pass in a valid XHR object having a url property containing the request Url.';\r\n    }\r\n\r\n    if (!xhr.getResponseHeader && typeof xhr.getResponseHeader === 'function') {\r\n      throw 'You have to pass in a valid XHR object having a getResponseHeader(key) function.';\r\n    }\r\n\r\n    if (!xhr.getResponseBody && typeof xhr.getResponseBody === 'function') {\r\n      throw 'You have to pass in a valid XHR object having a getResponseBody() function.';\r\n    }\r\n\r\n    if (xhr.status === 401 || xhr.status === 403) {\r\n      /*\r\n\t\t\t\tIf we are in here and the response came from the authentication library\r\n\t\t\t\twe should have received a response object of the following form:\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcode: string;\r\n\t\t\t\t\t\tredirectUrl: string;\r\n\t\t\t\t\t\tmessage: string;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\twhere the `code` property can be of the following:\r\n\t\t\t\t\t- PROFILE_INCOMPLETE\r\n\t\t\t\t\t- DELEGATION_NOT_VALID\r\n\t\t\t\t\t- AUTH_TYPE_NOT_SUPPORTED\r\n\t\t\t*/\r\n\r\n      const responseBody = xhr.getResponseBody();\r\n      if (responseBody && responseBody.redirectUrl) {\r\n        let redirectUrl = responseBody.redirectUrl;\r\n        if (redirectUrl.includes(this.REDIRECTURL_PLACEHOLDER)) {\r\n          redirectUrl = redirectUrl.replace(\r\n            this.REDIRECTURL_PLACEHOLDER,\r\n            encodeURIComponent(this._retrieveCurrentWindowUrl())\r\n          );\r\n        }\r\n\r\n        if (responseBody.message && responseBody.message !== '') {\r\n          if (egovAuthOptions.callbacks && egovAuthOptions.callbacks.notifyUser) {\r\n            egovAuthOptions.callbacks.notifyUser(responseBody);\r\n          } else {\r\n            console.warn(\r\n              'Missing callbacks: { notifyUser: (options) => { ... } } function. You should inform the user about what is going on! (redirecting silently..)'\r\n            );\r\n\r\n            this._redirect(redirectUrl);\r\n          }\r\n        } else {\r\n          this._redirect(redirectUrl);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private static _redirect(url: string) {\r\n    window.location.href = url;\r\n  }\r\n\r\n  private static _retrieveCurrentWindowUrl(): string {\r\n    return window.location.href;\r\n  }\r\n\r\n  private static _isNullOrUndefined(obj: any): boolean {\r\n    return obj === null || typeof obj === 'undefined';\r\n  }\r\n}\r\n","import { Delegation } from './models/delegation';\r\nimport { EgovAuthConfiguration } from './egovAuthConfiguration.interface';\r\nimport { User } from './user';\r\nimport { translate, AuthLanguageCode } from './localizations';\r\n\r\nexport class UIService {\r\n    private lang:AuthLanguageCode;\r\n\r\n    constructor(private user:User, egovAuthOptions:EgovAuthConfiguration) {\r\n\r\n        // calculate the language to be used\r\n        let lang:AuthLanguageCode = 'de';\r\n        if(egovAuthOptions.language) {\r\n\t\t\tlang = egovAuthOptions.language;\r\n\t\t} else if(user && user.language) {\r\n\t\t\tlang = user.language;\r\n\t\t} \r\n        this.lang = lang;\r\n    }\r\n\r\n    getCurrentLang() : AuthLanguageCode {\r\n        return this.lang;\r\n    }\r\n\r\n    translate(key): string {\r\n        return translate(this.lang, key);\r\n    }\r\n\r\n    resolveDelegationLinkText(delegation:Delegation): string {\r\n        const represented = delegation.represented;\r\n\r\n        if (represented.id === this.user.owner.id) {\r\n            return translate(this.lang, 'WorkForMe');\r\n        } else if (represented.naturalPerson) {\r\n            return `${represented.naturalPerson.firstname} ${represented.naturalPerson.lastname}`;\r\n        } else if (represented.juristicPerson) {\r\n            return this.returnLocalized(\r\n                    represented.juristicPerson.nameDe,\r\n                    represented.juristicPerson.nameIt);\r\n        }\r\n\r\n\t\treturn '(unable to determine link text)';\r\n    }\r\n\r\n    resolveDelegationDisplayName(): string {\r\n        let activeDelegation = this.user.activeDelegation;\r\n        if (activeDelegation) {\r\n            return this.resolveDelegationLinkText(activeDelegation);\r\n        }\r\n\r\n\t\treturn '(unable to determine delegation name)';\r\n    }\r\n\r\n    ellipsis(text: string, maxLength: number): string {\r\n        if (text) {\r\n            if (typeof maxLength === 'undefined') {\r\n                maxLength = 9000; //a large number\r\n            }\r\n\r\n            if (text.length <= maxLength)\r\n                return text;\r\n\r\n            var xMaxFit = maxLength - 3;\r\n            var xTruncateAt = text.lastIndexOf(' ', xMaxFit);\r\n            if (xTruncateAt == -1 || xTruncateAt < maxLength / 2)\r\n                xTruncateAt = xMaxFit;\r\n\r\n            return text.substr(0, xTruncateAt) + \"...\";\r\n        } else {\r\n            return text;\r\n        }\r\n    }\r\n\r\n    public returnLocalized(german: string, italian: string = german, english: string = german): string {\r\n        if (this.lang.toUpperCase() === 'IT') {\r\n            return italian;\r\n        } else if (this.lang.toUpperCase() === 'EN') {\r\n            return english;\r\n        } else {\r\n            return german;\r\n        }\r\n    }\r\n\r\n}\r\n","\r\nvar localizationTable = {\r\n    en: {\r\n        \"My Profile\": \"My Profile\",\r\n        \"AccessData\": \"Account Credentials\",\r\n        \"Delegations\": \"Delegations\",\r\n        \"MyRepresentatives\":\"Representatives\",\r\n        \"Work for someone else\": \"Work for someone else\",\r\n        \"DelegationNotAvailableInService\": \"not available for this service\",\r\n        \"NoDelegations\": \"you don't have any delegations\",\r\n        \"NewDelegationLinkText\": \"New Delegation\",\r\n\t\t\"WorkForMe\": \"Work for me\",\r\n\t\t\"wordFor\": \"on behalf of\",\r\n\t\t\"PossibleDelegations\": \"Possible Delegations\"\r\n    },\r\n\r\n    de: {\r\n        \"My Profile\": \"Mein Profil\",\r\n\t\t\"AccessData\": \"Zugangsdaten\",\r\n        \"Delegations\": \"Vertretungen\",\r\n        \"MyRepresentatives\":\"Vertreter\",\r\n        \"Work for someone else\": \"Für jemand anderen arbeiten\",\r\n        \"DelegationNotAvailableInService\": \"für diesen Dienst nicht verfügbar\",\r\n        \"NoDelegations\": \"Sie haben keine Vertretungen\",\r\n        \"NewDelegationLinkText\": \"Neue Vertretung beantragen\",\r\n\t\t\"WorkForMe\": \"Für mich arbeiten\",\r\n\t\t\"wordFor\": \"im Namen von\",\r\n\t\t\"PossibleDelegations\": \"Mögliche Vertretungen\"\r\n    },\r\n\r\n    it: {\r\n        \"My Profile\": \"Mio profilo\",\r\n\t\t\"AccessData\": \"Dati d'accesso\",\r\n        \"Delegations\": \"Deleghe\",\r\n        \"MyRepresentatives\":\"Rappresentanti\",\r\n        \"Work for someone else\": \"Lavorare per qualcun altro\",\r\n        \"DelegationNotAvailableInService\": \"non disponibile per questo servizio\",\r\n        \"NoDelegations\": \"non ha ancora nessuna delega\",\r\n        \"NewDelegationLinkText\": \"Richiesta nuova delega\",\r\n\t\t\"WorkForMe\": \"Lavorare per me stesso\",\r\n\t\t\"wordFor\": \"a nome di\",\r\n\t\t\"PossibleDelegations\": \"Deleghe possibili\"\r\n    }\r\n};\r\n\r\nexport function translate(lang: AuthLanguageCode, key) {\r\n\tlet language = lang.toLowerCase();\r\n    return localizationTable[language][key] || '[' + key + ']';\r\n}\r\n\r\nexport type AuthLanguageCode = 'de' | 'it' | 'en';\r\n","/** IE9, IE10 and IE11 requires all of the following polyfills. **/\r\n// import 'core-js/es6/symbol';\r\nimport 'core-js/es6/object';\r\n// import 'core-js/es6/function';\r\n// import 'core-js/es6/parse-int';\r\n// import 'core-js/es6/parse-float';\r\n// import 'core-js/es6/number';\r\n// import 'core-js/es6/math';\r\n// import 'core-js/es6/string';\r\n// import 'core-js/es6/date';\r\n// import 'core-js/es6/array';\r\n// import 'core-js/es6/regexp';\r\n// import 'core-js/es6/map';\r\n// import 'core-js/es6/weak-map';\r\n// import 'core-js/es6/set';\r\n\r\n// evergreen browsers need this\r\n// import 'core-js/es6/reflect';\r\n// import 'core-js/es7/reflect';\r\n"],"names":[],"mappings":"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"}